<html>
  <head>
    <link rel="stylesheet" href="todo/todo.css">
  </head>
  <body>
    <div class="section"></div>
    <main>
      <div class="fixed-action-btn">
      <a class="btn-floating btn-large add-todo">
        <i class="large material-icons" ng-click="addTodo()">add</i>
      </a>
      </div>
      <div class="row">
        <div class="list-group todos" ng-repeat="MainTodo in MainTodos">
          <div class="col s12 m6 l3 ">
            <a href="#/singletodo?todoID={{MainTodo.$id}}&projectID={{projectIDnum}}" class="linkToSingleTodo">
              <div class="card hoverable maincard card-fixed-height">
                <div class="card-content">
                  <span class="card-title activator grey-text text-darken-4"><b>{{MainTodo.nomTachePrincipale}}</b></span>
                  <p>
                    {{MainTodo.descriptionTachePrincipale}}
                  </p>
                  <p>
                    <div class="progress">
                      <div class="determinate" ng-class="MainTodo.progression <= 30 ? 'redBar' : MainTodo.progression < 60 ? 'orangeBar' : ''" style="width:{{MainTodo.progression}}%"></div>
                    </div>
                    <p><b>{{MainTodo.progression | number:0}}%</b></p>
                    <span>Date de début : {{MainTodo.dateDebut}}</span>
                    <p>
                      <span>Date de fin   : {{MainTodo.dateFinPrevue}}</span>
                    </p>
                  </p>
                  <br>
                  <div class="list-group" ng-repeat="(key, SubTodo) in MainTodo.tachesSecondaire">
                    <div class="col s12 m12 l12" ng-class="SubTodo.isOver ? 'isover-opacity' : ''">
                      <div class="card insidecard black-text">
                        <div class="card-content">
                          <a href="#/singletodo?todoID={{key}}" class="linkToSingleSubTodo">
                            <span class="card-title activator subtodo-title">{{SubTodo.nomTacheSecondaire}}</span>
                          </a>
                            <p>
                              <div class="switch">
                                <label>
                                  En cours
                                  <input type="checkbox" ng-checked="{{SubTodo.isOver}}">
                                  <span class="lever"  ng-click="setTodoState(MainTodo.$id, key)"></span>
                                  Terminée
                                </label>
                              </div>

                            </p>
                          <br>
                        </div>
                      </div>
                    </div>
                </div>
                <div class="row">
                  <center>
                    <div class="col s12 l12 m12">
                      <a class="waves-effect waves-light btn addsubtodo" ng-click="addSubTodo(MainTodo.$id)">Ajouter une tâche interne</a>
                    </div>
                  </center>
                </div>
              </div>
            </div>
          </a>
        </div>
        </div>
      </div>
    </main>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/js/materialize.min.js"></script>
  </body>
</html>
